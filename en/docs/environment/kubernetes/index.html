<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.108.0"><link rel=alternate type=text/html href=https://drupalwxt.github.io/en/docs/environment/kubernetes/_print/><link rel=alternate type=application/rss+xml href=https://drupalwxt.github.io/en/docs/environment/kubernetes/index.xml><meta name=robots content="index, follow"><link rel="shortcut icon" href=../../../../favicons/favicon.ico><title>Kubernetes | Drupal WxT</title><meta name=description content="Drupal WxT"><meta property="og:title" content="Kubernetes"><meta property="og:description" content="Drupal WxT"><meta property="og:type" content="website"><meta property="og:url" content="https://drupalwxt.github.io/en/docs/environment/kubernetes/"><meta property="og:site_name" content="Drupal WxT"><meta itemprop=name content="Kubernetes"><meta itemprop=description content="Drupal WxT"><meta name=twitter:card content="summary"><meta name=twitter:title content="Kubernetes"><meta name=twitter:description content="Drupal WxT"><link rel=preload href=../../../../scss/main.min.6adc39cf8935fbb3d26e584e218d355aef1903ad8d218e1d032ef2012b09162d.css as=style><link href=../../../../scss/main.min.6adc39cf8935fbb3d26e584e218d355aef1903ad8d218e1d032ef2012b09162d.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-00000000-0"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-00000000-0")}</script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=../../../../en/><span class="navbar-brand__logo navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 957 440"><defs><style>.wxt_logo{fill:#000}@media screen{.wxt_logo{fill:#000}}</style></defs><g transform="matrix(1,0,0,0.99999897,-9.6901386,-462.70603)"><path class="wxt_logo" d="M784.76421 462.90748C731.02378 462.32641 692.43028 462.92058 670.00747 465.81109 627.01699 471.36234 581.50604 521.32921 561.29903 556.61298 533.1225 598.63518 502.75047 688.71895 456.44715 688.45762 410.14383 688.19629 383.3898 586.46163 342.35988 586.87543 301.32996 587.28923 280.41575 681.13815 217.75409 680.85877 155.09243 680.5794 106.13019 521.18393 92.880525 462.95097H9.6901386C24.231399 554.63077 61.332242 625.08552 95.037833 673.97611 111.89062 698.42134 130.8032 720.94553 152.498 738.83848c21.6948 17.89309 36.79435 31.32425 78.72656 32.7585S310.59454 703.98949 336.85386 703.15671C361.10529 702.38761 367.52311 727.21076 358.42907 743.27683 349.33503 759.3429 325.08792 786.58449 316.37192 811.63499c-12.46372 35.82204-15.98038 67.51171-15.21365 90.09597L386.18296 901.44462C386.97642 857.40138 414.64036 778.01003 458.37203 775.64864 484.4689 775.57768 530.7786 820.59899 544.6176 838.95024 558.4566 857.30149 569.7218 874.82986 594.71632 889.25345S654.60982 905.15482 687.79769 893.30218C732.03818 877.50249 754.42732 835.1839 767.75116 795.52174 781.07499 755.85945 787.08531 711.72939 791.59405 669.88643 796.10281 628.04332 797.61781 603.23233 801.78169 576.96002 802.6265 571.62968 804.64498 552.07124 822.78338 547.72943 840.92177 543.38762 966.89118 546.85344 966.89118 546.85344L967.11932 462.8124S838.50471 463.48815 784.76427 462.90708zM719.12466 548.42285C711.60107 623.14542 709.98489 698.34966 687.10247 768.40741 681.56172 784.77829 660.87745 829.58569 637.20824 815.5576 633.78894 813.58447 624.96399 804.15123 612.5065 787.66591 598.42641 769.03327 577.6579 741.58571 546.2944 720.92616c23.04304-22.95619 41.22858-51.28996 56.39684-76.19101C620.23787 615.92959 632.36107 591.69362 632.4233 591.56916 632.42347 591.5689 632.4641 591.48806 632.4641 591.48806 649.71879 556.9987 688.33393 540.78276 719.12466 548.42285z"/></g></svg></span><span class=navbar-brand__name>Drupal WxT</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=../../../../en/docs/><span>WxT</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/drupalwxt target=_blank><span>GitHub</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/drupalwxt/wxt/releases target=_blank><span>Download</span></a></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=../../../../fr/>French</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search WxT" aria-label="Search WxT" autocomplete=off data-offline-search-index-json-src=../../../../offline-search-index.a5fa0420fb2d71e33839c824fb64844e.json data-offline-search-base-href=../../../../ data-offline-search-max-results=10></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search WxT" aria-label="Search WxT" autocomplete=off data-offline-search-index-json-src=../../../../offline-search-index.a5fa0420fb2d71e33839c824fb64844e.json data-offline-search-base-href=../../../../ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=../../../../fr/>French</a></div></div><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-endocs-li><a href=../../../../en/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-endocs><span>User Guide</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-endocsgeneral-li><a href=../../../../en/docs/general/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsgeneral><span>General</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsgeneralinstallation-li><a href=../../../../en/docs/general/installation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsgeneralinstallation><span>Installation</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsgeneralupdate-li><a href=../../../../en/docs/general/update/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsgeneralupdate><span>Update Process</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsgeneralreleases-li><a href=../../../../en/docs/general/releases/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsgeneralreleases><span>Releases</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsgeneralresources-li><a href=../../../../en/docs/general/resources/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsgeneralresources><span>Resources</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsgeneralroadmap-li><a href=../../../../en/docs/general/roadmap/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsgeneralroadmap><span>Roadmap</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-endocsdevelopment-li><a href=../../../../en/docs/development/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsdevelopment><span>Development</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsdevelopmentarchitecture-li><a href=../../../../en/docs/development/architecture/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsdevelopmentarchitecture><span>Architecture</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsdevelopmentcomposer-li><a href=../../../../en/docs/development/composer/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsdevelopmentcomposer><span>Composer</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsdevelopmentconfiguration-management-li><a href=../../../../en/docs/development/configuration-management/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsdevelopmentconfiguration-management><span>Configuration Management</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-endocsdevelopmentperformance-li><a href=../../../../en/docs/development/performance/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsdevelopmentperformance><span>Performance</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsdevelopmentperformancepostgresql-li><a href=../../../../en/docs/development/performance/postgresql/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsdevelopmentperformancepostgresql><span>PostgreSQL</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsdevelopmentperformanceredis-li><a href=../../../../en/docs/development/performance/redis/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsdevelopmentperformanceredis><span>Redis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsdevelopmentperformancevarnish-li><a href=../../../../en/docs/development/performance/varnish/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsdevelopmentperformancevarnish><span>Varnish</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsdevelopmentrelease-process-li><a href=../../../../en/docs/development/release-process/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsdevelopmentrelease-process><span>Release Process</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsdevelopmenttheming-li><a href=../../../../en/docs/development/theming/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsdevelopmenttheming><span>Theming</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-endocsdevelopmentversion-li><a href=../../../../en/docs/development/version/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsdevelopmentversion><span>Versioning</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-endocsenvironment-li><a href=../../../../en/docs/environment/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsenvironment><span>Environment</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-endocsenvironmentcontainers-li><a href=../../../../en/docs/environment/containers/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-endocsenvironmentcontainers><span>Containers</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-endocsenvironmentkubernetes-li><a href=../../../../en/docs/environment/kubernetes/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__section" id=m-endocsenvironmentkubernetes><span class=td-sidebar-nav-active-item>Kubernetes</span></a></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/drupalwxt/drupalwxt.github.io/tree/main/content/en/docs/environment/kubernetes/_index.en.md class=td-page-meta--view target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/drupalwxt/drupalwxt.github.io/edit/main/content/en/docs/environment/kubernetes/_index.en.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> View/Edit this page</a>
<a href="https://github.com/drupalwxt/drupalwxt.github.io/new/main/content/en/docs/environment/kubernetes/_index.en.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/drupalwxt/drupalwxt.github.io/issues/new?title=Kubernetes" class=td-page-meta--issue target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
<a id=print href=https://drupalwxt.github.io/en/docs/environment/kubernetes/_print/><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><ul><li><a href=#introduction>Introduction</a></li><li><a href=#kubernetes>Kubernetes</a><ul><li><a href=#key-points>Key Points</a></li></ul></li><li><a href=#government>Government</a></li><li><a href=#drupal-wxt-on-kubernetes>Drupal WxT on Kubernetes</a><ul><li><a href=#kubernetes-1>Kubernetes</a></li><li><a href=#ingress-controller>Ingress controller</a></li><li><a href=#varnish>Varnish</a></li><li><a href=#nginx>Nginx</a></li><li><a href=#web-php-fpm>Web (PHP-FPM)</a></li><li><a href=#redis>Redis</a></li><li><a href=#database>Database</a></li><li><a href=#stateful-assets>Stateful Assets</a><ul><li><a href=#azure-files-cifs--nfs>Azure Files (CIFS / NFS)</a></li></ul></li></ul></li></ul></li></ul></nav></div><div class="taxonomy taxonomy-terms-cloud taxo-tags"><h5 class=taxonomy-title>Tag Cloud</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/architecture/ data-taxonomy-term=architecture><span class=taxonomy-label>architecture</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/cache/ data-taxonomy-term=cache><span class=taxonomy-label>cache</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/cloud-native/ data-taxonomy-term=cloud-native><span class=taxonomy-label>cloud native</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/composer/ data-taxonomy-term=composer><span class=taxonomy-label>composer</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/configuration/ data-taxonomy-term=configuration><span class=taxonomy-label>configuration</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/containers/ data-taxonomy-term=containers><span class=taxonomy-label>containers</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/development/ data-taxonomy-term=development><span class=taxonomy-label>development</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/docker/ data-taxonomy-term=docker><span class=taxonomy-label>docker</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/environment/ data-taxonomy-term=environment><span class=taxonomy-label>environment</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/general/ data-taxonomy-term=general><span class=taxonomy-label>general</span><span class=taxonomy-count>6</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/helm/ data-taxonomy-term=helm><span class=taxonomy-label>helm</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/install/ data-taxonomy-term=install><span class=taxonomy-label>install</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/kubernetes/ data-taxonomy-term=kubernetes><span class=taxonomy-label>kubernetes</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/performance/ data-taxonomy-term=performance><span class=taxonomy-label>performance</span><span class=taxonomy-count>4</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/postgresql/ data-taxonomy-term=postgresql><span class=taxonomy-label>postgresql</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/redis/ data-taxonomy-term=redis><span class=taxonomy-label>redis</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/release/ data-taxonomy-term=release><span class=taxonomy-label>release</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/releases/ data-taxonomy-term=releases><span class=taxonomy-label>releases</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/resources/ data-taxonomy-term=resources><span class=taxonomy-label>resources</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/roadmap/ data-taxonomy-term=roadmap><span class=taxonomy-label>roadmap</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/theming/ data-taxonomy-term=theming><span class=taxonomy-label>theming</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/update/ data-taxonomy-term=update><span class=taxonomy-label>update</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/userguide/ data-taxonomy-term=userguide><span class=taxonomy-label>userguide</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/varnish/ data-taxonomy-term=varnish><span class=taxonomy-label>varnish</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/version/ data-taxonomy-term=version><span class=taxonomy-label>version</span><span class=taxonomy-count>1</span></a></li></ul></div><div class="taxonomy taxonomy-terms-cloud taxo-categories"><h5 class=taxonomy-title>Categories</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/categories/wxt/ data-taxonomy-term=wxt><span class=taxonomy-label>wxt</span><span class=taxonomy-count>21</span></a></li></ul></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=https://drupalwxt.github.io/en/docs/>User Guide</a></li><li class=breadcrumb-item><a href=https://drupalwxt.github.io/en/docs/environment/>Environment</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://drupalwxt.github.io/en/docs/environment/kubernetes/ aria-disabled=true class="btn-link disabled">Kubernetes</a></li></ol></nav><div class=td-content><h1>Kubernetes</h1><header class=article-meta><div class="taxonomy taxonomy-terms-article taxo-tags"><h5 class=taxonomy-title>Tags:</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/cloud-native/ data-taxonomy-term=cloud-native><span class=taxonomy-label>cloud native</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/helm/ data-taxonomy-term=helm><span class=taxonomy-label>helm</span></a></li><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/tags/kubernetes/ data-taxonomy-term=kubernetes><span class=taxonomy-label>kubernetes</span></a></li></ul></div><div class="taxonomy taxonomy-terms-article taxo-categories"><h5 class=taxonomy-title>Categories:</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://drupalwxt.github.io/en/categories/wxt/ data-taxonomy-term=wxt><span class=taxonomy-label>wxt</span></a></li></ul></div></header><p><img src=architecture.svg alt="Cloud Native Architecture"></p><h2 id=introduction>Introduction</h2><ul><li><strong><a href=https://github.com/drupalwxt/helm-drupal/blob/master/docs/diagram-drupal.pdf>Architectural Diagram</a></strong></li><li><strong><a href=https://github.com/drupalwxt/helm-drupal>Helm Chart for Drupal WxT</a></strong></li></ul><p>This document represents a high-level technical overview of how the <strong><a href=https://github.com/drupalwxt/helm-drupal>Helm Chart for Drupal WxT</a></strong> was built and how we envision <strong><a href=https://github.com/drupalwxt/wxt>Drupal</a></strong> itself should be architected in the cloud to support any of the Government of Canada procured cloud service providers (<code>AWS</code>, <code>Azure</code>, and <code>GCP</code>). It should be noted that this Helm chart would also work in an on-premise environment with the appropriate Kubernetes infrastructure.</p><p>A key mandate when creating this architecture was to follow the Open Source Directive as given by the Treasury Board Secretariat (C.2.3.8) which states that you should try to use open standards and open source software first. Additionally, where possible all functionality should be exposed as restful services and leverage microservices via a containerized approach (C2.3.10).</p><p>We are leveraging a microservices design pattern utilizing immutable and scanned images through containerization running on Kubernetes with a platform that has been built and open sourced by Statistics Canada. While the platform will be discussed briefly to provide context the bulk of the document discusses how Drupal is installed and configured on top of it.</p><h2 id=kubernetes>Kubernetes</h2><div class="alert alert-info" role=alert>The base of the platform - Kubernetes is the first graduate of the <strong><a href=https://www.cncf.io>CNCF</a></strong> (Cloud Native Computing Foundation).</div><p><strong><a href=https://kubernetes.io>Kubernetes</a></strong> orchestrates the computing, networking, and storage infrastructure on behalf of user workloads. It assigns workloads and resources to a series of nearly identically-configured virtual machines.</p><p>Kukbernetes supports workloads running anywhere, from IoT devices, to private cloud and all the way to public cloud. This is possible due to Kubernetes&rsquo; pluggable architecture, which defines interfaces that are then implemented for the different environments. Kubernetes provides an Infrastructure as Code environment defined through declarative configuration. Because Kubernetes abstracts away the implementation of the computing environment, application dependencies such as storage, networking, etc., applications do not have to concern themselves with these differences.</p><p>Kubernetes is backed by a huge (10,000+) and vibrant growing community, consisting of end users, business, vendors and large cloud providers.</p><h3 id=key-points>Key Points</h3><p>This architecture brings many benefits to the Government of Canada:</p><ul><li>Support for hybrid workloads (Linux and Windows), deployed using the same methodology</li><li>Abstraction of underlying hardware (&ldquo;cattle rather than pets&rdquo;) enabling an automated, highly-available and scaleable infrastructure for microservices</li><li>Declarative configuration enabling Infrastructure as Code allowing for deployment automation, reproducibility and re-use</li><li>Constructs to support advanced deployment patterns (blue/green, canary, etc.) enabling zero-downtime deployments</li><li>Platform-level tooling for traffic handling (routing, error recovery, encyption, etc.), monitoring, observability and logging, and secrets management</li></ul><p>Kubernetes is supported across all cloud service providers (fully managed and self managed), preventing vendor lock-in. Managed offerings are available from Google, IBM, Azure, Digital Ocean, Amazon, Oracle and more. The choice whether to roll your own, using a managed service (AKS, EKS, GKE) or a Platform as a Service (OpenShift, Pivotal) is up to the organization to decide based on their requirements and risks. Our preference is to stay as close as possible to the open source version of Kubernetes as well as tooling in order to remain compatible with the different Kubernetes offerings (raw, managed, platform, etc.).</p><h2 id=government>Government</h2><p>Kubernetes is being actively investigated and/or used by many departments across the Government of Canada. Departments are starting to collaborate more and work together towards a common, well-vetted solution and this is why we have have Open Sourced our platform on the GC Accelerators hoping to foster this collaboration and form a community of practice.</p><p>Provided below is the Terraform (Infrastructure as Code) necessarily to install the Azure Kubernetes Service Infrastructure as well as configure with optional platform components (RBAC, Service Mesh, Policies, etc).</p><ul><li><strong><a href=https://github.com/canada-ca-terraform-modules/terraform-kubernetes-aks>Terraform for Kubernetes Infrastructure</a></strong></li><li><strong><a href=https://github.com/canada-ca-terraform-modules/terraform-kubernetes-aks-platform>Terraform for Kubernetes Platform</a></strong></li></ul><h2 id=drupal-wxt-on-kubernetes>Drupal WxT on Kubernetes</h2><p>A managed Drupal Platform as a Service is a strong candidate to take advantage of what a Kubernetes platform offers. The design enables a quick onboarding of new workloads through the repeatable deployment methodology provided by Kubernetes.</p><h3 id=kubernetes-1>Kubernetes</h3><p><strong>Recommendation:</strong> <strong><a href=https://kubernetes.io>Kubernetes</a></strong></p><ul><li><strong><a href=https://github.com/drupalwxt/helm-drupal>Helm Chart for Drupal WxT</a></strong></li></ul><p>Kubernetes is the basis of the Drupal platform and was further discussed above.</p><p>The whole Drupal application stack can be easily installed in a distributed fashion in minutes using our Helm chart, The chart facilitates a managed service workflow (rolling updates, cronjobs, health checks, auto-scaling, etc.) without user intervention.</p><h3 id=ingress-controller>Ingress controller</h3><p><strong>Recommendation:</strong> <strong><a href=https://istio.io/docs/tasks/traffic-management/ingress/ingress-control>Istio</a></strong></p><p>The ingress controller is responsible for accepting external HTTPS connections and routing them to backend applications based on configuration defined in Kubernetes Ingress objects. Routing can be done by domain and/or path.</p><h3 id=varnish>Varnish</h3><p><strong>Recommendation:</strong> <strong><a href=https://varnish-cache.org>Varnish</a></strong></p><p>Varnish is a highly customizable reverse proxy cache. This will aid in supporting a large number of concurrent visitors as the final rendered pages can be served from cache. Varnish is only required on the public environment and is not used in the content staging environment.</p><p>Nginx can technically address some of the cache requirements needed, however the open source version does not support purging selective pages. We need to clear caches based on content being updated / saved which Varnish supports along with the Expire Drupal module quite readily</p><h3 id=nginx>Nginx</h3><p><strong>Recommendation:</strong> <strong><a href=https://www.nginx.com>Nginx</a></strong></p><p>Nginx is an open source web server that can also be used a reverse proxy, HTTP cache, and load balancer. Due to its root in performance optimization under scale, Nginx often outperforms similarly popular web servers and is built to offer low memory usage, and high concurrency.</p><h3 id=web-php-fpm>Web (PHP-FPM)</h3><p><strong>Recommendation:</strong> <strong><a href=https://php-fpm.org>PHP-FPM</a></strong></p><p>Drupal runs in the PHP runtime environment. PHP-FPM is the process manager organized as a master process managing pools of individual worker processes. Its architecture shares design similarities with event-driven web servers such as Nginx and allows for PHP scripts to use as much of the server's available resources as necessary without additional overhead that comes from running them inside of web server processes.</p><p>The PHP-FPM master process dynamically creates and terminates worker processes (within configurable limits) as traffic to PHP scripts increases and decreases. Processing scripts in this way allows for much higher processing performance, improved security, and better stability. The primary performance benefits from using PHP-FPM are more efficient PHP handling and ability to use opcode caching.</p><h3 id=redis>Redis</h3><p><strong>Recommendation:</strong> <strong><a href=https://redis.io>Redis</a></strong></p><p>Redis is an advanced key-value cache and store.</p><p>It is often referred to as a data structure server since keys can contain strings, hashes, lists, sets, sorted sets, bitmaps, etc.</p><p>Redis is particularly useful when using cloud managed databases to limit the overall database load and to make performance more consistent.</p><h3 id=database>Database</h3><p><strong>Recommendation:</strong> <strong><a href=https://www.mysql.com>MySQL</a></strong> or <strong><a href=https://www.postgresql.org>PostgreSQL</a></strong></p><ul><li><strong><a href=https://github.com/canada-ca-terraform-modules/terraform-azurerm-mysql>Terraform for MySQL Database</a></strong></li><li><strong><a href=https://github.com/canada-ca-terraform-modules/terraform-azurerm-postgresql>Terraform for PostgreSQL Database</a></strong></li></ul><p>Drupal maintains its state in a database and while supports several types only MySQL or PostgreSQL should be considered. Personally, we highly recommend PostgreSQL based on the experience we had building / launching quite a few Drupal sites in the cloud with it. However both run quite well with minimal operational concerns. Additionally the Helm Chart supports connection pooling using either <strong><a href=https://proxysql.com>ProxySQL</a></strong> and / or <strong><a href=https://www.pgbouncer.org>PGBouncer</a></strong> depending on the database used.</p><ul><li><strong><a href=https://proxysql.com>ProxySQL</a></strong></li><li><strong><a href=https://www.pgbouncer.org>PGBouncer</a></strong></li></ul><blockquote><p><strong>Note</strong>: Our recommendation would be to use a managed database offering from the cloud providers for a production environment. Coupled with a managed file service, this removes all stateful components from the cluster enabling the best application experience possible.</p></blockquote><h3 id=stateful-assets>Stateful Assets</h3><p>Drupal stores generated CSS/JS assets and uploaded content (images, videos, etc.) in a file storage. As the architecture is designed to be distributed, this present some design considerations for us.</p><h4 id=azure-files-cifs--nfs>Azure Files (CIFS / NFS)</h4><p>Fully managed file shares in the cloud that are accessible via Server Message Block (SMB) or NFS protocol. Support is provided for dynamically creating and using a persistent volume with Azure Files in the Azure Kubernetes Service.</p><p>For more information on <strong><a href=https://azure.microsoft.com/en-us/services/storage/files/#overview>Azure Files</a></strong>, please see <strong><a href=https://docs.microsoft.com/en-us/azure/aks/azure-files-dynamic-pv>Azure Files and AKS</a>.</strong></p><blockquote><p><strong>Note</strong>: This is currently our recommended choice as it results in a simpler installation in Azure then relying on an S3 compatible object store discussed below. Similar storage solutions exist with the other cloud providers.</p></blockquote><div class=section-index></div><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/drupalwxt/drupalwxt.github.io/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/drupalwxt/drupalwxt.github.io/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof ga!="function")return;const t={command:"send",hitType:"event",category:"Helpful",action:"click",label:window.location.pathname,value:e};ga(t.command,t.hitType,t.category,t.action,t.label,t.value)};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(1)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br><div class="text-muted mt-5 pt-3 border-top">Last modified 2021-12-30: <a href=https://github.com/drupalwxt/drupalwxt.github.io/commit/09ca55b5d07d23f01fa7e0f9eb536bc6717b441f>feat(initial): first content pass (09ca55b5)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Drupal WxT Discussions" aria-label="Drupal WxT Discussions"><a class=text-white target=_blank rel=noopener href=https://github.com/drupalwxt/wxt/discussions aria-label="Drupal WxT Discussions"><i class="fas fa-users"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Contributions Wanted" aria-label="Contributions Wanted"><a class=text-white target=_blank rel=noopener href=https://github.com/drupalwxt/wxt aria-label="Contributions Wanted"><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Drupal Issue Queue" aria-label="Drupal Issue Queue"><a class=text-white target=_blank rel=noopener href=https://drupal.org/project/issues/wxt aria-label="Drupal Issue Queue"><i class="fab fa-drupal"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="GitHub Pages" aria-label="GitHub Pages"><a class=text-white target=_blank rel=noopener href=https://github.com/drupalwxt/drupalwxt.github.io aria-label="GitHub Pages"><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 Drupal WxT All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/mermaid@8.11.2/dist/mermaid.min.js integrity=sha384-m8Pdaep6Qk8sW3J6XhPOiwUww3maU9HxZTLvEfSEB4e1UVvTdHyfJsYmEfYqvwLC crossorigin=anonymous></script>
<script src=../../../../js/tabpane-persist.js></script>
<script src=../../../../js/main.min.e62440dbb3af8184519d8ebd61da3704e90f225d76876419d05624752626e018.js integrity="sha256-5iRA27OvgYRRnY69Ydo3BOkPIl12h2QZ0FYkdSYm4Bg=" crossorigin=anonymous></script></body></html>